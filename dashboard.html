<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sublime Logs — Dashboard</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Lobster&display=swap" rel="stylesheet">

<style>
:root{
  --primary-gradient: linear-gradient(90deg, #9b59b6, #e91e63);
  --card-bg: #ffffff;
  --muted: #6b7280;
  --success: #16a34a;
  --danger: #ef4444;
  --glass: rgba(255,255,255,0.8);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  margin:0;
  background: linear-gradient(180deg,#f3f6fb,#ffffff);
  color:#0f172a;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Header */
header.app-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:12px 16px;
  background: var(--primary-gradient);
  color:white;
  position:sticky;
  top:0;
  z-index:50;
  box-shadow: 0 6px 18px rgba(0,0,0,0.12);
}
.brand{
  display:flex;
  align-items:center;
  gap:12px;
}
.brand h1{
  font-family: 'Lobster', cursive;
  margin:0;
  font-size:20px;
  letter-spacing:0.2px;
}
.icon-btn{
  background:transparent;
  border:none;
  color:white;
  font-size:22px;
  padding:8px;
}
.back-home{
  background:white;
  color:#9b59b6;
  padding:8px 12px;
  border-radius:8px;
  text-decoration:none;
  font-weight:600;
}

/* Layout */
.container{
  display:flex;
  min-height:calc(100vh - 64px);
  transition: margin-left .3s;
}

/* Side menu */
nav.side-menu{
  width:280px;
  max-width:80%;
  background: var(--primary-gradient);
  border-right:1px solid rgba(15,23,42,0.04);
  padding:18px 12px;
  transform: translateX(-320px);
  transition: transform .28s ease;
  position:fixed;
  top:64px;
  left:0;
  bottom:0;
  z-index:60;
  box-shadow: 12px 0 30px rgba(2,6,23,0.06);
  overflow:auto;
  border-top-right-radius:12px;
  border-bottom-right-radius:12px;
  color:white;
}
nav.side-menu.open{ transform: translateX(0); }
nav.side-menu h3{ margin:0 0 10px 6px; font-size:14px; color:white }
nav.side-menu ul{ list-style:none; padding:0; margin:10px 0 0 }
nav.side-menu li{
  padding:12px 10px;
  margin-bottom:6px;
  border-radius:8px;
  cursor:pointer;
  font-weight:600;
}
nav.side-menu li:hover{ background: rgba(255,255,255,0.1) }

.close-menu{
  float:right;
  font-size:20px;
  cursor:pointer;
  padding:6px;
  color:white;
}

/* Main content area */
main.content{
  flex:1;
  padding:22px;
  margin-left:0;
  width:100%;
  transition: margin-left .28s;
}
@media(min-width:880px){
  nav.side-menu{ transform: translateX(0); position:relative; top:0; left:0; height:auto; box-shadow:none; }
  main.content{ margin-left: 280px; }
}

/* Profile card */
.profile-card{
  display:flex;
  gap:18px;
  align-items:center;
  padding:18px;
  background:var(--card-bg);
  border-radius:12px;
  box-shadow: 0 6px 18px rgba(12,23,51,0.06);
  margin-bottom:18px;
}
.avatar{
  width:84px; height:84px; border-radius:50%;
  background: url('https://cdn-icons-png.flaticon.com/512/149/149071.png') center/cover no-repeat;
  border:4px solid rgba(13,42,87,0.06);
  cursor:pointer;
  flex-shrink:0;
  position:relative;
  overflow:hidden;
}
.avatar .edit-dot{
  position:absolute; right:6px; bottom:6px;
  background:white; color:#9b59b6;
  font-weight:700; border-radius:50%; width:28px; height:28px;
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 4px 10px rgba(2,6,23,0.08);
  font-size:14px;
}
.profile-info h2{ margin:0; font-size:18px }
.profile-info p{ margin:6px 0 0; color:var(--muted) }

.balance{
  margin-left:auto;
  text-align:right;
}
.balance .label{ font-size:12px; color:var(--muted) }
.balance .amount{ font-size:20px; font-weight:700; color:#9b59b6 }

/* Action buttons row */
.actions{ display:flex; gap:10px; flex-wrap:wrap; margin-bottom:18px; }
.btn{
  padding:10px 14px; border-radius:10px; border:none; cursor:pointer;
  background: var(--primary-gradient); color:white; font-weight:700;
  box-shadow:0 6px 18px rgba(155,89,182,0.2);
}
.btn.ghost{ background:transparent; color:#9b59b6; border:1px solid rgba(155,89,182,0.3) }

/* Card */
.card{
  background:var(--card-bg);
  padding:16px;
  border-radius:12px;
  box-shadow:0 6px 18px rgba(12,23,51,0.04);
  margin-bottom:18px;
}

/* Transactions table */
table{ width:100%; border-collapse:collapse; font-size:14px; }
th,td{ padding:12px 10px; border-bottom:1px solid rgba(15,23,42,0.04); text-align:left }
th{ color: #06102b; font-weight:700; font-size:13px }
.small{ font-size:13px; color:var(--muted) }

/* Modals */
.modal-backdrop{
  position:fixed; inset:0; background:rgba(2,6,23,0.45);
  display:none; align-items:center; justify-content:center; z-index:120;
}
.modal-backdrop.open{ display:flex; }
.modal{
  width:95%; max-width:520px; background:white; padding:18px; border-radius:12px;
  box-shadow:0 20px 60px rgba(2,6,23,0.3);
}
.modal h3{ margin:0 0 12px; color:#9b59b6 }

.form-row{ margin-bottom:10px; }
.form-row label{ display:block; font-size:13px; color:var(--muted); margin-bottom:6px }
.form-row input, .form-row textarea{
  width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(12,23,51,0.06);
  outline:none; font-size:14px;
}

.toast-wrap{ position:fixed; right:18px; bottom:18px; z-index:140; display:flex; flex-direction:column; gap:8px; }
.toast{ padding:10px 12px; border-radius:10px; color:white; font-weight:700; min-width:180px; display:flex; gap:8px; align-items:center; box-shadow:0 8px 26px rgba(2,6,23,0.18) }
.toast.success{ background:var(--success) }
.toast.error{ background:var(--danger) }

/* Responsive */
@media(max-width:760px){
  .profile-card{ flex-direction:row; gap:12px; align-items:center }
  .balance{ margin-left:0; text-align:left }
}

/* tiny helpers */
.muted{ color:var(--muted) }
.gap-12{ gap:12px }
</style>
</head>
<body>
<!-- Header -->
<header class="app-header">
  <div class="brand">
    <button class="icon-btn" id="menu-btn" aria-label="Open menu">☰</button>
    <h1>Sublime Logs</h1>
  </div>
  <div style="display:flex;align-items:center;gap:12px">
    <a class="back-home" href="#" id="back-home">Back to Homepage</a>
    <button class="icon-btn" id="logout-btn" title="Log out">⎋</button>
  </div>
</header>

<div class="container">
  <!-- Side Menu -->
  <nav class="side-menu" id="side-menu" aria-hidden="true">
    <span class="close-menu" id="close-menu" title="Close menu">✕</span>
    <h3>Quick Actions</h3>
    <ul>
      <li id="menu-profile">Profile</li>
      <li id="menu-fund">Fund Account</li>
      <li id="menu-buy">Buy Number</li>
      <li id="menu-send">Send Gift</li>
      <li id="menu-transactions">Transaction History</li>
      <li id="menu-logout">Logout</li>
    </ul>
  </nav>

  <!-- Main content -->
  <main class="content" id="main-content">
    <div class="profile-card card">
      <div class="avatar" id="avatar" title="Click to upload avatar">
        <div class="edit-dot">✎</div>
      </div>

      <div class="profile-info">
        <h2 id="user-name">Welcome</h2>
        <p id="user-email" class="muted">your.email@example.com</p>
        <div class="small muted" id="member-since">Member since: —</div>
      </div>

      <div class="balance">
        <div class="label small">Balance</div>
        <div class="amount" id="balance">₦0.00</div>
      </div>
    </div>

    <div class="actions">
      <button class="btn" id="btn-profile">Profile</button>
      <button class="btn" id="btn-fund">Fund Account</button>
      <button class="btn" id="btn-buy">Buy Number</button>
      <button class="btn" id="btn-send">Send Gift</button>
      <button class="btn ghost" id="btn-trans-history">Transaction History</button>
    </div>

    <div class="card">
      <h3 style="margin-top:0">Transaction History</h3>
      <div style="overflow:auto">
        <table aria-live="polite" id="transactions-table">
          <thead>
            <tr>
              <th>Type</th>
              <th>Amount</th>
              <th>Date</th>
              <th>Status</th>
              <th>Reference</th>
            </tr>
          </thead>
          <tbody>
            <!-- rows injected here -->
          </tbody>
        </table>
      </div>
    </div>
  </main>
</div>

<!-- Hidden file input for avatar -->
<input id="avatar-input" type="file" accept="image/*" style="display:none" />

<!-- Modals -->
<div class="modal-backdrop" id="modal-backdrop">
  <div class="modal" role="dialog" aria-modal="true" id="modal">
    <!-- dynamic content injected -->
  <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-analytics.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";
import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-storage.js";

// Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyDVu5IQ3Y5bvgAfSKym8kXPpZZWKqMELTM",
  authDomain: "sublime-logs.firebaseapp.com",
  projectId: "sublime-logs",
  storageBucket: "sublime-logs.firebasestorage.app",
  messagingSenderId: "381847722551",
  appId: "1:381847722551:web:8ec68f018291d3927f3db2",
  measurementId: "G-8YHHJC1MP7"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const db = getFirestore(app);
const storage = getStorage(app);

// Demo user data
let currentUser = {
  uid: "demo_user",
  name: "John Doe",
  email: "johndoe@example.com",
  balance: 0,
  avatarUrl: "https://cdn-icons-png.flaticon.com/512/149/149071.png"
};

// DOM Elements
const menuBtn = document.getElementById('menu-btn');
const sideMenu = document.getElementById('side-menu');
const closeMenu = document.getElementById('close-menu');
const avatarEl = document.getElementById('avatar');
const avatarInput = document.getElementById('avatar-input');
const userNameEl = document.getElementById('user-name');
const userEmailEl = document.getElementById('user-email');
const balanceEl = document.getElementById('balance');
const transactionsTable = document.getElementById('transactions-table').querySelector('tbody');
const modalBackdrop = document.getElementById('modal-backdrop');
const modal = document.getElementById('modal');

// Menu toggle
menuBtn.addEventListener('click', () => sideMenu.classList.add('open'));
closeMenu.addEventListener('click', () => sideMenu.classList.remove('open'));

// Populate user data
function updateUserUI(){
  userNameEl.textContent = currentUser.name;
  userEmailEl.textContent = currentUser.email;
  balanceEl.textContent = `₦${currentUser.balance.toFixed(2)}`;
  avatarEl.style.backgroundImage = `url(${currentUser.avatarUrl})`;
}

// Avatar upload
avatarEl.addEventListener('click', () => avatarInput.click());
avatarInput.addEventListener('change', async (e)=>{
  const file = e.target.files[0];
  if(!file) return;
  const storageReference = storageRef(storage, `avatars/${currentUser.uid}/${file.name}`);
  await uploadBytes(storageReference, file);
  const url = await getDownloadURL(storageReference);
  currentUser.avatarUrl = url;
  updateUserUI();
});

// Paystack funding
async function fundAccount(amount){
  const handler = PaystackPop.setup({
    key: 'YOUR_PUBLIC_KEY', // Replace with your Paystack public key
    email: currentUser.email,
    amount: amount * 100, // in kobo
    currency: "NGN",
    callback: async function(response){
      // Record transaction in Firestore
      await addDoc(collection(db, "transactions"), {
        userId: currentUser.uid,
        type: "fund",
        amount: amount,
        status: "success",
        reference: response.reference,
        timestamp: serverTimestamp()
      });
      currentUser.balance += amount;
      updateUserUI();
      loadTransactions();
      alert("Funding successful! Reference: "+response.reference);
    },
    onClose: function(){
      alert('Payment window closed.');
    }
  });
  handler.openIframe();
}

// Load transactions from Firestore
async function loadTransactions(){
  transactionsTable.innerHTML = '';
  const q = query(collection(db, "transactions"), orderBy("timestamp", "desc"));
  const snapshot = await getDocs(q);
  snapshot.forEach(doc=>{
    const tx = doc.data();
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${tx.type}</td>
      <td>₦${tx.amount}</td>
      <td>${tx.timestamp?.toDate().toLocaleString() || '-'}</td>
      <td>${tx.status}</td>
      <td>${tx.reference}</td>
    `;
    transactionsTable.appendChild(tr);
  });
}

// Button events
document.getElementById('btn-fund').addEventListener('click', ()=>{
  const amount = parseFloat(prompt("Enter amount to fund account:", "500"));
  if(amount && !isNaN(amount)){
    fundAccount(amount);
  }
});

// Initial setup
updateUserUI();
loadTransactions();
</script>

<!-- Paystack SDK -->
<script src="https://js.paystack.co/v1/inline.js"></script>
</body>
  </html>
